# Консольный менеджер контактов

Это простое консольное Java-приложение для управления списком контактов. 
Проект создан с использованием Spring Framework для демонстрации принципов инверсии управления (IoC) и внедрения зависимостей (DI).

## Функционал

Приложение поддерживает следующие команды, которые вводятся в консоль после запуска:

*   `list` — Показать все сохраненные контакты.
*   `add <ФИО;Телефон;Email>` — Добавить новый контакт. Данные должны быть разделены точкой с запятой.
    *   *Пример:* `add иванов иван иванович;+79991234567;ivan@email.com`
*   `delete <Email>` — Удалить контакт по его адресу электронной почты.
    *   *Пример:* `delete ivan@email.com`
*   `save` — Принудительно сохранить текущий список контактов в файл.
*   `help` — Показать список всех доступных команд.
*   `exit` — Сохранить контакты в файл и завершить работу приложения.

## Настройки

Все настройки находятся в файле `src/main/resources/application.properties`.

*   `app.storage.path` — Путь к файлу, в котором хранятся контакты. По умолчанию: `contacts.txt` (создается в корне проекта при добавлении контакта).
*   `app.init.path` — Путь к файлу для начальной инициализации контактов. По умолчанию используется ресурс `classpath:default-contacts.txt`.
*   `spring.profiles.active=default,init` - эта настройка в файле application.properties активирует два профиля: 
     'default' для основной работы 
     'init' для автоматической загрузки контактов из файла default-contacts.txt при старте приложения.

## Как это работает

   Приложение запустится, загрузит контакты командой `init' из файла `src/main/resources/default-contacts.txt` и будет готово к работе.
   Вся работа по созданию и связыванию объектов выполняется фреймворком Spring. 

1.  **Точка входа (`Application.java`)**:
    *   Метод `main` создает контекст-центральный интерфейс ApplicationContext , который является контейнером с реализацией`AnnotationConfigApplicationContext`. 
        Это "мозг" Spring, который ищет и управляет нашими классами.
    *   Мы передаем ему `AppConfig.class` — главный конфигурационный класс, говорим- читай его.

2.  **Конфигурация (`AppConfig.java`)**:
    *   Аннотация `@Configuration` говорит Spring, что это класс с настройками.
    *   Аннотация `@ComponentScan("by.spvrent.contactmanager")` дает команду Spring: "просканируй весь пакет `by.spvrent.contactmanager` и найди все классы, помеченные специальными аннотациями".
    *   Аннотация `@PropertySource("classpath:application.properties")` дает команду Spring "просканируй `resources/application.properties` и найди там все свойства и загрузи их в Environment".

3.  **Компоненты (наши классы)**:
    *   Spring находит классы, помеченные `@Component` или его разновидностями (`@Service`, `@Repository`, `@Controller`(нет в проекте, приложение консольное)). 
        Он создает по одному экземпляру каждого такого класса (это bean).
    *   `@Repository` (`InMemoryContactRepository`): Класс для работы с данными.
    *   `@Service` (`ContactServiceImpl`): Класс для бизнес-логики.
    *   `@Component` (`ConsoleInputHandler`, `ContactInitializer`): Общая аннотация для любого управляемого Spring компонента.

4.  **Внедрение зависимостей (DI)**:
    *   Когда Spring создает бин (например, `ConsoleInputHandler`), он смотрит на его конструктор.
    *   Он видит, что конструктору нужен `ContactService`.
    *   Spring находит в своем контейнере уже созданный бин `ContactServiceImpl` (который является реализацией `ContactService`) и автоматически "подставляет" его в конструктор.
    *   Этот процесс называется **внедрением зависимостей**. Нам не нужно вручную писать `new ContactServiceImpl()`, Spring делает это за нас.

5.  **Запуск логики после настройки с помощью `@PostConstruct`**:

     В приложении используется единый подход для запуска логики после создания бинов — аннотация `@PostConstruct`. 
     Spring вызывает метод, помеченный этой аннотацией, сразу после того, как бин был полностью создан и все его зависимости внедрены.

    *  ContactInitializer**: Если при запуске активен профиль `init`, Spring создает этот бин и вызывает его метод `initialize()`, помеченный `@PostConstruct`. 
       Этот метод загружает первоначальный список контактов из файла.

    *  ConsoleInputHandler**: Сразу после создания этого бина Spring вызывает его метод `startConsoleListener()`, также помеченный `@PostConstruct`. 
       Этот метод запускает основной цикл приложения в отдельном потоке, который начинает слушать команды пользователя.

Этот унифицированный подход делает код чище и избавляет классы от необходимости реализовывать специфичные для Spring интерфейсы, такие как `InitializingBean`.


Таким образом, Spring берет на себя всю "скучную" работу по созданию и связыванию объектов, позволяя нам сосредоточиться на написании бизнес-логики.

